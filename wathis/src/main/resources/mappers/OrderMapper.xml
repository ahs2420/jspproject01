<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.OrderMapper">
	<select id="getAll" resultType="ordervo">
		SELECT 
			id,
			member_id,
			product_id,
			price,
			donation,
			delivery_fee,
			payment,
			account_num,
			account_name,
			account_bank,
			pay_type,
			receiver_addr1,
			receiver_addr2,
			receiver_addr3,
			receiver_tel,
			receiver_name,
			receiver_etc,
			state,
			delivery_id,
			delivery_number,
			reg_date
		FROM
			tb_order
		ORDER BY id DESC
	</select>
	<select id="getOrderCount" resultType="int">
		SELECT 
			count(id)
		FROM
			tb_order
		WHERE member_id = #{member_id}
	</select>
	<select id="getOrderList" resultType="ordervo">
		SELECT 
			id,
			member_id,
			product_id,
			price,
			donation,
			delivery_fee,
			payment,
			account_num,
			account_name,
			account_bank,
			pay_type,
			receiver_addr1,
			receiver_addr2,
			receiver_addr3,
			receiver_tel,
			receiver_name,
			receiver_etc,
			state,
			delivery_id,
			delivery_number,
			reg_date
		FROM
			tb_order
		WHERE member_id = #{member_id}
		ORDER BY id DESC
	</select>
	<select id="getOrderDetail" resultType="ordervo">
		SELECT 
			id,
			member_id,
			product_id,
			price,
			donation,
			delivery_fee,
			payment,
			account_num,
			account_name,
			account_bank,
			pay_type,
			receiver_addr1,
			receiver_addr2,
			receiver_addr3,
			receiver_tel,
			receiver_name,
			receiver_etc,
			state,
			delivery_id,
			delivery_number,
			reg_date
		FROM
			tb_order
		WHERE id = #{id}
	</select>
	<insert id="setOrder">
		INSERT INTO tb_order SET
			member_id=#{member_id},
			product_id=#{product_id},
			price=#{price},
			donation=${donation},
			delivery_fee=#{delivery_fee},
			payment=#{payment},
			account_num=#{account_num},
			account_name=#{account_name},
			account_bank=#{account_bank},
			pay_type=1,
			receiver_addr1=#{receiver_addr1},
			receiver_addr2=#{receiver_addr2},
			receiver_addr3=#{receiver_addr3},
			receiver_tel=#{receiver_tel},
			receiver_name=#{receiver_name},
			receiver_etc=#{receiver_etc},
			state=1
	</insert>
	<update id="updateOrder">
		UPDATE SET tb_order
			state=#{state},
			delivery_id=#{delivery_id},
			delivery_number=#{delivery_number}
		WHERE id=#{id}
	</update>
	<update id="updateOrderStatus">
		UPDATE SET tb_order
			state=#{state}
		WHERE id=#{id}
	</update>
	<delete id="deleteOrder">
		DELETE FROM tb_order
		WHERE id=#{id}
	</delete>
</mapper>